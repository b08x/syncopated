---
- name: Ensure RPM passenger-phusion key
  when: ansible_distribution == 'RedHat'
  tags:
  - configuration
  - nginx
  ansible.builtin.rpm_key:
    key: https://packagecloud.io/gpg.key
    validate_certs: true

- name: Ensure passenger yum repo file exists
  when: ansible_distribution == 'RedHat'
  tags:
  - configuration
  - nginx
  ansible.builtin.template:
    src: nginx.repo.j2
    dest: /etc/yum.repos.d/passenger.repo

- name: force yum to import gpgkey
  tags:
  - configuration
  - nginx
  ansible.builtin.shell: yum -qy repolist
